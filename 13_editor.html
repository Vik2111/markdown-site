<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä —Å—Ç–∞—Ç–µ–π –¥–ª—è Markdown Site</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1e293b 0%, #7e22ce 50%, #1e293b 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="p-4">
    <div class="max-w-7xl mx-auto">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl p-6 mb-6">
            <h1 class="text-4xl font-bold text-white mb-2 flex items-center gap-3">
                üìù –†–µ–¥–∞–∫—Ç–æ—Ä —Å—Ç–∞—Ç–µ–π
            </h1>
            <p class="text-purple-200">–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç–∞—Ç—å—é –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Markdown</p>
        </div>

        <div class="grid lg:grid-cols-2 gap-6">
            <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl shadow-xl p-6 space-y-4">
                <h2 class="text-2xl font-bold text-white mb-4">–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—å–∏</h2>
                
                <div>
                    <label class="block text-purple-200 mb-2 font-medium">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                    <input type="text" id="title" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏">
                </div>

                <div>
                    <label class="block text-purple-200 mb-2 font-medium">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="description" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" rows="2" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏"></textarea>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-purple-200 mb-2 font-medium">üìÖ –î–∞—Ç–∞</label>
                        <input type="date" id="date" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50">
                    </div>

                    <div>
                        <label class="block text-purple-200 mb-2 font-medium">Slug (URL)</label>
                        <input type="text" id="slug" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" placeholder="my-article-slug">
                    </div>
                </div>

                <div>
                    <label class="block text-purple-200 mb-2 font-medium">üè∑Ô∏è –¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <input type="text" id="tags" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" placeholder="–∂–∏–∑–Ω—å, –∫–æ–¥–∏–Ω–≥, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">
                </div>

                <div>
                    <label class="block text-purple-200 mb-2 font-medium">üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–ø—É—Ç—å)</label>
                    <input type="text" id="image" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" placeholder="/images/my-photo.jpg">
                </div>

                <div class="flex items-center gap-3">
                    <input type="checkbox" id="published" checked class="w-5 h-5 rounded bg-white/20 border-purple-400/30">
                    <label for="published" class="text-purple-200 font-medium">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é</label>
                </div>

                <div>
                    <label class="block text-purple-200 mb-2 font-medium">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</label>
                    <div class="mb-2 flex gap-2 flex-wrap">
                        <button onclick="addImage()" class="bg-purple-500/30 text-white px-3 py-1 rounded text-sm hover:bg-purple-500/50 transition-all" type="button">
                            + –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        </button>
                        <button onclick="addImageWithSize()" class="bg-purple-500/30 text-white px-3 py-1 rounded text-sm hover:bg-purple-500/50 transition-all" type="button">
                            + –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ä–∞–∑–º–µ—Ä–æ–º
                        </button>
                        <button onclick="addHeading()" class="bg-purple-500/30 text-white px-3 py-1 rounded text-sm hover:bg-purple-500/50 transition-all" type="button">
                            + –ó–∞–≥–æ–ª–æ–≤–æ–∫
                        </button>
                    </div>
                    <textarea id="content" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50 font-mono text-sm" rows="12" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏... –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Markdown.
–î–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ![–û–ø–∏—Å–∞–Ω–∏–µ](/images/photo.jpg)"></textarea>
                </div>

                <div class="flex gap-3">
                    <button onclick="downloadMarkdown()" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all flex items-center justify-center gap-2 shadow-lg">
                        ‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å .md —Ñ–∞–π–ª
                    </button>
                    
                    <button onclick="copyToClipboard()" class="bg-white/20 text-white px-6 py-3 rounded-lg font-semibold hover:bg-white/30 transition-all">
                        –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                    </button>

                    <button onclick="togglePreview()" class="bg-white/20 text-white px-6 py-3 rounded-lg font-semibold hover:bg-white/30 transition-all">
                        üëÅÔ∏è
                    </button>
                </div>
            </div>

            <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl shadow-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-4" id="previewTitle">Markdown –∫–æ–¥</h2>
                
                <div id="previewMarkdown" class="bg-slate-900/50 rounded-lg p-4 text-green-300 text-sm overflow-auto max-h-[600px] font-mono"></div>
                
                <div id="previewVisual" class="bg-white/5 rounded-lg p-6 text-white space-y-4 hidden">
                    <h1 class="text-3xl font-bold" id="previewHeading">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1>
                    <p class="text-purple-200 italic" id="previewDesc">–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</p>
                    <div id="previewTags" class="flex gap-2 flex-wrap"></div>
                    <div id="previewImage" class="text-sm text-purple-300"></div>
                    <div class="border-t border-purple-400/30 pt-4 whitespace-pre-wrap" id="previewContent">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...</div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
        <div class="mt-6 bg-white/10 backdrop-blur-lg rounded-2xl shadow-xl p-6">
            <h3 class="text-xl font-bold text-white mb-3">üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</h3>
            <ol class="text-purple-200 space-y-2 list-decimal list-inside">
                <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã –∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</li>
                <li>–î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "üìÅ –í—ã–±—Ä–∞—Ç—å" (–æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤)</li>
                <li>–ù–∞–∂–º–∏—Ç–µ "üì¶ –°–∫–∞—á–∞—Ç—å ZIP –∞—Ä—Ö–∏–≤" - —Å–∫–∞—á–∞–µ—Ç—Å—è –∞—Ä—Ö–∏–≤ —Å–æ —Å—Ç–∞—Ç—å—ë–π –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</li>
                <li>–†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤:
                    <ul class="ml-6 mt-2 space-y-1 list-disc">
                        <li><code class="bg-white/20 px-2 py-1 rounded">article.md</code> ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ <code class="bg-white/20 px-2 py-1 rounded">content\blog\</code></li>
                        <li><code class="bg-white/20 px-2 py-1 rounded">images\</code> ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ <code class="bg-white/20 px-2 py-1 rounded">public\images\</code></li>
                    </ul>
                </li>
                <li>–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:</li>
            </ol>
            <div class="mt-3 bg-slate-900/50 rounded-lg p-4">
                <code class="text-green-300">C:\Users\anika\Music\antigravity\markdown-site-main&gt;deploy.bat</code>
            </div>
            <p class="text-purple-200 mt-3">‚úÖ –í–∞—à–∞ —Å—Ç–∞—Ç—å—è –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥—É—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –Ω–∞ GitHub –∏ –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ!</p>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
    <div id="imageModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto">
        <div class="bg-gradient-to-br from-slate-800 to-purple-900 rounded-2xl p-8 max-w-md w-full my-8 shadow-2xl">
            <h3 class="text-2xl font-bold text-white mb-4">–î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-purple-200 mb-2 font-medium">–ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é</label>
                    <div class="flex gap-2">
                        <input type="text" id="modalImagePath" class="flex-1 px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" placeholder="/images/my-photo.jpg">
                        <button onclick="selectImageFile()" class="bg-purple-500/50 hover:bg-purple-500/70 text-white px-4 py-3 rounded-lg transition-all flex items-center gap-2">
                            <span>üìÅ</span> –í—ã–±—Ä–∞—Ç—å
                        </button>
                    </div>
                    <input type="file" id="imageFileInput" accept="image/*" class="hidden">
                    <p class="text-purple-300 text-sm mt-2">–ü—Ä–∏–º–µ—Ä—ã –ø—É—Ç–µ–π:</p>
                    <div class="text-purple-300 text-xs mt-1 space-y-1">
                        <div>/images/photo.jpg</div>
                        <div>/assets/pic.png</div>
                        <div>https://example.com/img.jpg</div>
                    </div>
                </div>
                
                <div>
                    <label class="block text-purple-200 mb-2 font-medium">–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="modalImageAlt" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">
                </div>
                
                <div id="modalImageWidth" class="hidden">
                    <label class="block text-purple-200 mb-2 font-medium">–®–∏—Ä–∏–Ω–∞ (–ø–∏–∫—Å–µ–ª–∏)</label>
                    <input type="number" id="modalImageWidthValue" class="w-full px-4 py-3 rounded-lg bg-white/20 text-white placeholder-purple-300 border border-purple-400/30 focus:border-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500/50" value="500">
                </div>
                
                <div id="imagePreview" class="hidden">
                    <label class="block text-purple-200 mb-2 font-medium">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</label>
                    <div class="max-h-48 overflow-hidden rounded-lg border border-purple-400/30">
                        <img id="imagePreviewImg" class="w-full h-full object-contain bg-black/20">
                    </div>
                </div>
            </div>
            
            <div class="flex gap-3 mt-6">
                <button onclick="confirmImageModal()" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all">
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
                <button onclick="closeImageModal()" class="bg-white/20 text-white px-6 py-3 rounded-lg font-semibold hover:bg-white/30 transition-all">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <script>
        let showPreview = false;
        let imageModalMode = 'normal'; // 'normal' or 'withSize'
        let selectedImageData = null;
        let uploadedImages = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
        document.getElementById('date').valueAsDate = new Date();

        // –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è slug –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        document.getElementById('title').addEventListener('input', function() {
            const slugField = document.getElementById('slug');
            if (!slugField.value) {
                const slug = this.value
                    .toLowerCase()
                    .replace(/[^–∞-—èa-z0-9\s-]/g, '')
                    .replace(/\s+/g, '-')
                    .replace(/-+/g, '-')
                    .trim();
                slugField.value = slug;
            }
            updatePreview();
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
        ['description', 'date', 'slug', 'tags', 'image', 'content', 'published'].forEach(id => {
            document.getElementById(id).addEventListener('input', updatePreview);
        });

        function generateMarkdown() {
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const date = document.getElementById('date').value;
            const slug = document.getElementById('slug').value;
            const published = document.getElementById('published').checked;
            const tags = document.getElementById('tags').value;
            const image = document.getElementById('image').value;
            const content = document.getElementById('content').value;

            const tagsArray = tags
                .split(',')
                .map(tag => `"${tag.trim()}"`)
                .filter(tag => tag !== '""')
                .join(', ');

            return `---
title: "${title}"
description: "${description}"
date: "${date}"
slug: "${slug}"
published: ${published}
tags: [${tagsArray}]
image: "${image}"
---

${content}`;
        }

        function updatePreview() {
            const markdown = generateMarkdown();
            document.getElementById('previewMarkdown').textContent = markdown;

            // –í–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–≤—å—é
            const title = document.getElementById('title').value || '–ó–∞–≥–æ–ª–æ–≤–æ–∫';
            const description = document.getElementById('description').value || '–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏';
            const tags = document.getElementById('tags').value;
            const image = document.getElementById('image').value;
            const content = document.getElementById('content').value || '–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...';

            document.getElementById('previewHeading').textContent = title;
            document.getElementById('previewDesc').textContent = description;
            document.getElementById('previewContent').textContent = content;

            // –¢–µ–≥–∏
            const tagsDiv = document.getElementById('previewTags');
            tagsDiv.innerHTML = '';
            if (tags) {
                tags.split(',').forEach(tag => {
                    if (tag.trim()) {
                        const span = document.createElement('span');
                        span.className = 'bg-purple-500/30 px-3 py-1 rounded-full text-sm';
                        span.textContent = tag.trim();
                        tagsDiv.appendChild(span);
                    }
                });
            }

            // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const imageDiv = document.getElementById('previewImage');
            imageDiv.textContent = image ? `üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${image}` : '';
        }

        function togglePreview() {
            showPreview = !showPreview;
            const markdownDiv = document.getElementById('previewMarkdown');
            const visualDiv = document.getElementById('previewVisual');
            const title = document.getElementById('previewTitle');

            if (showPreview) {
                markdownDiv.classList.add('hidden');
                visualDiv.classList.remove('hidden');
                title.textContent = '–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—å–∏';
            } else {
                markdownDiv.classList.remove('hidden');
                visualDiv.classList.add('hidden');
                title.textContent = 'Markdown –∫–æ–¥';
            }
        }

        function downloadMarkdown() {
            const markdown = generateMarkdown();
            const slug = document.getElementById('slug').value || 'article';
            
            if (uploadedImages.length > 0) {
                // –°–æ–∑–¥–∞–µ–º ZIP –∞—Ä—Ö–∏–≤ —Å .md —Ñ–∞–π–ª–æ–º –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
                const zip = new JSZip();
                
                // –î–æ–±–∞–≤–ª—è–µ–º .md —Ñ–∞–π–ª
                zip.file(`${slug}.md`, markdown);
                
                // –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É images –≤ –∞—Ä—Ö–∏–≤–µ
                const imagesFolder = zip.folder('images');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                uploadedImages.forEach(img => {
                    imagesFolder.file(img.file.name, img.file);
                });
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º ZIP
                zip.generateAsync({type: 'blob'}).then(function(content) {
                    const url = URL.createObjectURL(content);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${slug}.zip`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    alert(`‚úÖ –°–∫–∞—á–∞–Ω ZIP –∞—Ä—Ö–∏–≤ —Å:\n- ${slug}.md\n- ${uploadedImages.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ø–∞–ø–∫–µ images/\n\n–†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤:\n- ${slug}.md ‚Üí content/blog/\n- images/ ‚Üí public/images/`);
                });
            } else {
                // –ï—Å–ª–∏ –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–∫–∞—á–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ .md —Ñ–∞–π–ª
                const blob = new Blob([markdown], { type: 'text/markdown;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${slug}.md`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }

        function copyToClipboard() {
            const markdown = generateMarkdown();
            navigator.clipboard.writeText(markdown).then(() => {
                alert('Markdown —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            });
        }

        function selectImageFile() {
            document.getElementById('imageFileInput').click();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
        document.getElementById('imageFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –≤ –ø–æ–ª–µ –ø—É—Ç–∏
                document.getElementById('modalImagePath').value = `/images/${file.name}`;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —É–ø–∞–∫–æ–≤–∫–∏ –≤ ZIP
                uploadedImages.push({
                    file: file,
                    path: `/images/${file.name}`
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                const reader = new FileReader();
                reader.onload = function(event) {
                    selectedImageData = event.target.result;
                    document.getElementById('imagePreviewImg').src = event.target.result;
                    document.getElementById('imagePreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
                const altField = document.getElementById('modalImageAlt');
                if (!altField.value || altField.value === '–û–ø–∏—Å–∞–Ω–∏–µ') {
                    const fileName = file.name.replace(/\.[^/.]+$/, '').replace(/[-_]/g, ' ');
                    altField.value = fileName.charAt(0).toUpperCase() + fileName.slice(1);
                }
            }
        });

        function addImage() {
            imageModalMode = 'normal';
            document.getElementById('modalImageWidth').classList.add('hidden');
            document.getElementById('modalImagePath').value = '/images/my-photo.jpg';
            document.getElementById('modalImageAlt').value = '–û–ø–∏—Å–∞–Ω–∏–µ';
            document.getElementById('imageModal').classList.remove('hidden');
        }

        function addImageWithSize() {
            imageModalMode = 'withSize';
            document.getElementById('modalImageWidth').classList.remove('hidden');
            document.getElementById('modalImagePath').value = '/images/my-photo.jpg';
            document.getElementById('modalImageAlt').value = '–û–ø–∏—Å–∞–Ω–∏–µ';
            document.getElementById('modalImageWidthValue').value = '500';
            document.getElementById('imageModal').classList.remove('hidden');
        }

        function closeImageModal() {
            document.getElementById('imageModal').classList.add('hidden');
            document.getElementById('imagePreview').classList.add('hidden');
            selectedImageData = null;
            document.getElementById('imageFileInput').value = '';
        }

        function confirmImageModal() {
            const path = document.getElementById('modalImagePath').value.trim();
            if (!path) {
                alert('–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é!');
                return;
            }
            
            const alt = document.getElementById('modalImageAlt').value || '–û–ø–∏—Å–∞–Ω–∏–µ';
            let img;
            
            if (imageModalMode === 'withSize') {
                const width = document.getElementById('modalImageWidthValue').value || '500';
                img = `<img src="${path}" alt="${alt}" width="${width}">`;
            } else {
                img = `![${alt}](${path})`;
            }
            
            const contentField = document.getElementById('content');
            contentField.value += (contentField.value ? '\n\n' : '') + img;
            updatePreview();
            closeImageModal();
        }

        function addHeading() {
            const heading = prompt('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞:', '–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞');
            if (heading) {
                const text = `## ${heading}`;
                const contentField = document.getElementById('content');
                contentField.value += (contentField.value ? '\n\n' : '') + text;
                updatePreview();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–≤—å—é
        updatePreview();
    </script>
</body>
</html>